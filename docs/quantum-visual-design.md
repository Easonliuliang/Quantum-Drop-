# Quantum Drop · 量子传输视觉系统设计

> 设计理念：「量子相位转移」—— 文件不是被"发送"，而是被相位转移：从经典物理世界坍缩进入量子场，再通过纠缠态瞬间重构于目标点。

---

## 一、视觉架构：三层沉浸系统

### 1.1 第1层：量子场背景（Quantum Field）
**永恒运行的底层，用户始终处于量子领域中**

| 元素 | 描述 | 技术 |
|------|------|------|
| 虚空网格 | 深空背景中缓慢呼吸的细线网格 | WebGL Shader (Simplex Noise) |
| 概率云 | 半透明粒子云的随机涨落，量子叠加的视觉隐喻 | GPU Particle System |
| 色彩 | 极深蓝紫 `#02020a` → 靛蓝 `#1a0a2e` | Linear Gradient |

**Shader 核心参数：**
```glsl
uniform float time;
uniform vec2 resolution;

// 量子场波动
float quantumField(vec2 uv) {
  float n1 = snoise(vec3(uv * 2.0, time * 0.05));
  float n2 = snoise(vec3(uv * 5.0, time * 0.1 + 100.0));
  return n1 * 0.6 + n2 * 0.4;
}
```

### 1.2 第2层：事件视界（Event Horizon）
**用户与量子场的交互界面，平时隐形，文件靠近时显现**

| 状态 | 视觉效果 |
|------|----------|
| 待机 | 微妙的引力透镜，鼠标移动时背景轻微扭曲 |
| 文件接近 | 空间弯曲效应，文件边缘产生引力红移/蓝移 |
| 悬停确认 | 视界发光，产生吸积盘的旋转效果 |

**物理隐喻：**
- **蓝移（Blueshift）**：拖拽速度快时，文件前端呈现青色光谱
- **红移（Redshift）**：文件尾端呈现红色光谱
- **时间膨胀**：文件在视界边缘产生拖影，仿佛进入慢动作

### 1.3 第3层：量子隧道（Quantum Tunnel）
**传输过程中的虫洞开启，最核心的视觉震撼**

#### 阶段 A：坍缩启动（0-20%）
- 文件螺旋坍缩，形成旋转的吸积盘
- 周围空间向中心聚集能量

#### 阶段 B：隧道形成（20-80%）
- **隧道壁**：旋转的能量螺旋，纯能量构成
- **粒子流**：沿隧道轴向喷射的高能粒子（比特流的视觉化）
- **色彩编码**：
  - 🔵 LAN 传输：`#00f3ff` 青色
  - 🟣 P2P 中继：`#bc13fe` 紫色
  - 🟠 中继模式：`#ff6b35` 橙色

#### 阶段 C：坍缩完成（80-100%）
- 文件坍缩为一点，产生闪光
- PoT 收据从虚空中浮现

---

## 二、交互流程：零按钮设计

### 2.1 完全去除传统 UI

| 传统 UI | 量子替代方案 |
|---------|-------------|
| 选择文件按钮 | **点击虚空任意处** → 唤起系统文件选择 |
| 开始传输按钮 | **双击文件** → 自动坍缩并开始 |
| 进度条 | **隧道亮度/速度** 表示进度 |
| 传输状态 | **色彩语言** 表示路由类型 |
| 完成通知 | **PoT Receipt** 从虚空中浮现 |

### 2.2 交互状态机

```typescript
type QuantumState = 
  | 'VOID'           // 待机：平静量子场
  | 'DISTORTION'     // 文件靠近：空间弯曲
  | 'COLLAPSE'       // 开始传输：坍缩动画
  | 'TUNNEL'         // 传输中：虫洞隧道
  | 'DECOHERENCE';   // 完成：坍缩为收据
```

### 2.3 唯一的常驻元素

**量子比特指示器（Quantum Bit Indicator）**
- 位置：右下角
- 外观：缓慢脉动的光点
- 状态：
  - 缓慢呼吸（在线）
  - 快速闪烁（传输中）
  - 红色警报（错误）

---

## 三、技术实现架构

### 3.1 核心渲染栈

```
┌─────────────────────────────────────┐
│         React (状态管理)              │
├─────────────────────────────────────┤
│      Quantum Visual Controller      │
│      (状态机 + 动画编排)              │
├─────────────────────────────────────┤
│   ┌─────────────┐  ┌─────────────┐  │
│   │  Quantum    │  │  Wormhole   │  │
│   │  Field      │  │  Portal     │  │
│   │  (WebGL)    │  │  (Three.js) │  │
│   └─────────────┘  └─────────────┘  │
├─────────────────────────────────────┤
│   ┌─────────────┐  ┌─────────────┐  │
│   │  Particle   │  │  Post       │  │
│   │  System     │  │  Processing │  │
│   │  (GPU)      │  │  (Bloom等)  │  │
│   └─────────────┘  └─────────────┘  │
└─────────────────────────────────────┘
```

### 3.2 关键组件

#### QuantumFieldBackground
- 职责：永恒运行的背景量子场
- 技术：Canvas 2D 或 WebGL Shader
- 性能：目标 60fps，移动端适配

#### EventHorizon
- 职责：文件拖拽的引力效应
- 技术：位移贴图 + 色彩分离
- 输入：鼠标/触摸位置、拖拽速度

#### WormholePortal
- 职责：传输隧道的 3D 可视化
- 技术：Three.js TubeGeometry + Custom Shader
- 动态：根据传输进度调整隧道深度

#### ParticleStream
- 职责：高能粒子流效果
- 技术：GPU Instanced Particles
- 参数：速度、密度、色彩

#### CollapseEffect
- 职责：文件坍缩和收据浮现
- 技术：CSS Animation + Canvas
- 触发：传输开始/完成

### 3.3 色彩系统

```css
:root {
  /* 虚空 */
  --void-deep: #02020a;
  --void-mid: #0a0a1a;
  --void-light: #1a0a2e;
  
  /* 量子态 */
  --quantum-cyan: #00f3ff;
  --quantum-cyan-glow: rgba(0, 243, 255, 0.6);
  --quantum-purple: #bc13fe;
  --quantum-purple-glow: rgba(188, 19, 254, 0.6);
  --quantum-orange: #ff6b35;
  --quantum-orange-glow: rgba(255, 107, 53, 0.6);
  
  /* 能量 */
  --energy-white: #e0f7ff;
  --energy-dim: rgba(224, 247, 255, 0.3);
}
```

### 3.4 动画时序

| 阶段 | 时长 | 缓动函数 |
|------|------|----------|
| 空间扭曲 | 300ms | `cubic-bezier(0.16, 1, 0.3, 1)` |
| 坍缩启动 | 500ms | `cubic-bezier(0.7, 0, 0.84, 0)` |
| 隧道形成 | 800ms | `cubic-bezier(0.16, 1, 0.3, 1)` |
| 传输循环 | 持续 | 线性，随进度加速 |
| 坍缩完成 | 600ms | `cubic-bezier(0.34, 1.56, 0.64, 1)` |

---

## 四、实现路线图

### 阶段 1：量子场背景 ✅
- [x] WebGL Shader 基础框架
- [x] Simplex Noise 波动效果
- [x] 呼吸动画
- [x] 响应式适配

### 阶段 2：事件视界 ✅
- [x] 引力透镜扭曲效果
- [x] 文件拖拽检测
- [x] 红移/蓝移色彩分离
- [x] 空间弯曲 Shader

### 阶段 3：量子隧道 ✅
- [x] Three.js 隧道几何体
- [x] 螺旋能量壁 Shader
- [x] 粒子流系统
- [x] 传输状态绑定

### 阶段 4：坍缩效果 ✅
- [x] 文件坍缩动画
- [x] PoT 收据浮现
- [x] 闪光效果
- [x] 收据卡片组件

### 阶段 5：整合优化
- [ ] 状态机整合
- [ ] 性能优化
- [ ] 移动端适配
- [ ] 降级方案（低端设备）

---

## 五、参考与灵感

- **《星际穿越》**：卡冈图雅黑洞的吸积盘
- **量子力学**：波函数坍缩、量子纠缠
- **科幻界面**：《遗落南境》的 shimmer 效果
- **游戏**：《死亡搁浅》的丘比特连接器
- **科学可视化**：LHC 粒子对撞轨迹

---

## 六、设计原则

1. **物理真实感**：每个效果都有量子物理隐喻
2. **沉浸优先**：去除所有打破沉浸的传统 UI
3. **反馈清晰**：引力、色彩、运动传达状态
4. **技术炫耀**：展示 WebGL 和 Three.js 的极限
5. **品牌独特**：创造市面上独一无二的体验

---

*设计版本：v1.0*
*最后更新：2026-01-28*
